---
title: "Exam Results Analysis"
author: "Liena Kāpiņa"
date: "12/08/2025"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Data obtained from <https://www.viaa.gov.lv/lv/valsts-parbaudes-darbu-statistika>

[Add description of data!!]

# Cleaning the data
Renaming data so important column names match between the two types of exams and important fields do not contain special characters.

```{r load}
library(readxl)
ol <- read_excel("visi_dati_2024_0810.xlsx", sheet = "MATOL")
al <- read_excel("visi_dati_2024_0810.xlsx", sheet = "MATAL")
colnames(al)[5] <- '1 dala'
colnames(al)[7] <- '2 dala'
colnames(al)[9] <- '3 dala'
colnames(al)[11] <- '4 dala'
colnames(ol)[5] <- '1 dala'
colnames(ol)[7] <- '2 dala'
colnames(al)[colnames(al) == 'Urbanizācija'] <- 'Urbanizacija'
colnames(ol)[colnames(ol) == 'Urbanizācija'] <- 'Urbanizacija'
```

Remove unnecessary columns.

```{r clean}
ol$N.p.k. <- NULL
ol$Norise <- NULL
ol$`Procenti Zināšanas. izpratne un prasmes` <- NULL
ol$`Procenti Kompleksu problēmu risināšana` <- NULL
ol$`Procenti kopā` <- NULL
al$N.p.k.<- NULL
al$Norise <- NULL
al$`Procenti Zināšanas. izpratne un prasmes (optimālā līmeņa saturs)` <- NULL
al$`Procenti Kompleksu problēmu risināšana (optimālā līmeņa saturs)` <- NULL
al$`Procenti Zināšanas. izpratne un prasmes (augstākā līmeņa saturs)` <- NULL
al$`Procenti Kompleksu problēmu risināšana (augstākā līmeņa saturs)` <- NULL
al$`Procenti kopā` <- NULL
```

Add missing columns so data frames for MATOL and MATAL can be merged into one.

```{r, merge}
ol$`3 dala` <- as.double(NA)
ol$`4 dala` <- as.double(NA)
data <- rbind(ol, al)
```

# Descriptive Data Analysis

Let's compare the number of people taking the exam in each type of school. Rows are Riga, then state significance cities, regional significance cities and finally countryside. Columns are secondary school, distance learning secondary school, state gymnasium, professional education and University of Latvia. Note that in University of Latvia only people already with a secondary school diploma take exams.

```{r proportions}
library(pander)
proportions <- table (data$Urbanizacija, data$Tips)
rownames(proportions) <- c("Riga", "State city", "Regional city", "Countryside")
colnames(proportions) <- c("Secondary", "Distance", "Gymnasium", "Pofessional ed", "UL")
pander(proportions, caption = "Number of Exam Takers")
```
Let's calculate the mean scores of the first part of the exam. The maximum number of points in this part was 75.

```{r means1}
split <- split(data, data$Urbanizacija)
riga <- split$`1`
city <- split$`2`
town <- split$`3`
country <- split$`4`
means <- aggregate(riga$`1 dala`, list(riga$Tips), FUN=mean)
colnames(means)[colnames(means) == 'Group.1'] <- 'Type'
colnames(means)[colnames(means) == 'x'] <- 'Riga'
col <- aggregate(city$`1 dala`, list(city$Tips), FUN=mean)
col[nrow(col) + 1,] <- c(9, NA)
means$'City' <- col$'x'
col <- aggregate(town$`1 dala`, list(town$Tips), FUN=mean)
col[nrow(col) + 1,] <- c(9, NA)
means$'Town' <- col$'x'
col <- aggregate(country$`1 dala`, list(country$Tips), FUN=mean)
col[nrow(col) + 1,] <- c(9, NA)
col <- rbind(col[1:2,], c(6, NA), col[-(1:2),])
means$'Country' <- col$'x'
means
```
Then do the same for the second part of the exam. The maximum number of points in this part was 25.

```{r means2, include=FALSE}
means <- aggregate(riga$`2 dala`, list(riga$Tips), FUN=mean)
colnames(means)[colnames(means) == 'Group.1'] <- 'Type'
colnames(means)[colnames(means) == 'x'] <- 'Riga'
col <- aggregate(city$`2 dala`, list(city$Tips), FUN=mean)
col[nrow(col) + 1,] <- c(9, NA)
means$'City' <- col$'x'
col <- aggregate(town$`2 dala`, list(town$Tips), FUN=mean)
col[nrow(col) + 1,] <- c(9, NA)
means$'Town' <- col$'x'
col <- aggregate(country$`2 dala`, list(country$Tips), FUN=mean)
col[nrow(col) + 1,] <- c(9, NA)
col <- rbind(col[1:2,], c(6, NA), col[-(1:2),])
means$'Country' <- col$'x'
```
```{r means2results}
means
```
Let's look at the histograms of first part results from secondary schools.

```{r secondary_hist, echo=FALSE}
rsplit <- split(riga, riga$Tips)
riga_secondary <- rsplit$'3'
cisplit <- split(city, city$Tips)
city_secondary <- cisplit$`3`
tsplit <- split(town, town$Tips)
town_secondary <- tsplit$'3'
cosplit <- split(country, country$Tips)
country_secondary <- cosplit$'3'

par(mfrow = c(2,2))
hist(riga_secondary$`1 dala`, probability = TRUE, xlim = c(0, 80), ylim = c(0, 0.03), main ="Riga secondary school scores", xlab = "Part 1 points")
hist(city_secondary$`1 dala`, probability = TRUE, xlim = c(0, 80), ylim = c(0, 0.03), main ="State cities' secondary school scores", xlab = "Part 1 points")
hist(town_secondary$`1 dala`, probability = TRUE, xlim = c(0, 80), ylim = c(0, 0.03), main ="Regional cities' secondary school scores", xlab = "Part 1 points")
hist(country_secondary$`1 dala`, probability = TRUE, xlim = c(0, 80), ylim = c(0, 0.03), main ="Countryside secondary school scores", xlab = "Part 1 points")
```








